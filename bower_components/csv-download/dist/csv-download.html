<!--
  <csv-download>

  @element csv-download
  @demo https://chris-l.github.io/csv-download/
--><html><head><script>!function(){"use strict";function a(a,c){return c=c||",","object"!=typeof a||null===a?"":b(a,function(a){return b(a,function(a){function b(a,b){if("object"==typeof b&&null!==b){if(-1!==d.indexOf(b))return;d.push(b)}return b}var d=[];return"string"!=typeof a&&(a=JSON.stringify(a,b).replace(/^"|"$/g,""),d=null),RegExp(c+'|"').test(a)&&(a='"'+a.replace(/"/g,'""')+'"'),a}).join(c)}).join("\r\n")}var b,c,d,e;d=Object.create(HTMLLinkElement.prototype),b=Function.prototype.call.bind(Array.prototype.map),e=function(){function a(a,b){switch(b){case Object:case Array:return JSON.parse(a);default:return a||""}}function b(a){return a.replace(/([A-Z])/g,"-$1").toLowerCase()}var c={};return c.serialize=function(a){return"string"==typeof a?String(a):JSON.stringify(a)},c.syncProperty=function(b,c,d,e){if(c[d]){var f=c[d].type||c[d];b[d]=a(e,f)}},c.init=function(d,e){Object.defineProperty(d,"props",{enumerable:!1,configurable:!0,value:{}}),Object.keys(e).forEach(function(f){var g,h=b(f);g=e[f].type?e[f]:{type:e[f]},d.props[f]=d[f]||g.value,null===d.getAttribute(h)?g.reflectToAttribute&&d.setAttribute(h,c.serialize(d.props[f])):d.props[f]=a(d.getAttribute(h),g.type),Object.defineProperty(d,f,{get:function(){return d.props[f]||a(d.getAttribute(h),g.type)},set:function(a){d.props[f]=a,g.reflectToAttribute&&d.setAttribute(h,c.serialize(a)),"function"==typeof d[g.observer]&&d[g.observer](a)}})})},c}(),d.createURI=function(){this.csvString=a(this.data,this.delimiter),this.setAttribute("href","data:text/csv,"+encodeURIComponent(this.csvString))},c={data:{type:Object,value:"",observer:"createURI"},download:{type:String,value:"data.csv",reflectToAttribute:!0},delimiter:{type:String,value:",",observer:"createURI"}},d.attributeChangedCallback=function(a,b,d){e.syncProperty(this,c,a,d)},d.createdCallback=function(){e.init(this,c),this.createURI(),this.addEventListener("click",function(a){var b;this.createURI(),window.navigator&&window.navigator.msSaveOrOpenBlob&&(a.preventDefault(),b=new Blob([this.csvString]),window.navigator.msSaveOrOpenBlob(b,this.download))},!0)},document.registerElement("csv-download",{prototype:d,"extends":"a"})}();</script>
</head><body></body></html>